# 观察者模式



### 天气预报项目需求

* 要求
  1. 气象站可以将每天测量到的温度、湿度、气压等, 以公告的形式发布出去.(比如发布到自己的网站或者第三方)
  2. 需要设计开放型API, 便于其他第三方也能接入气象站获取数据.
  3. 提供温度、气压和湿度的接口.
  4. 测量数据更新时, 要能实时通知到第三方.



### 解决方案

* 普通方案

  * 方案一

    通过对气象站项目需求的分析, 我们可以初步设计一个 WeatherData 类, 包含温度等属性, 并提供相应的get方法, 以及一个 dataChange 方法

    说明: get方法可以让第三方接入, 并获取相关信息. 当数据有更新时, 气象站可以调用 dataChange 方法, 去更新数据, 当第三方再次获取数据时, 就可以拿到最新数据.

  * 方案二

    WeatherData 类通过维护第三方的 对象 来进行推送.

* 观察者模式



### 观察者模式原理

* 观察者模式类似订牛奶业务
  1. 奶站/气象站: Subject
  2. 用户/第三方: Observe
* Subject: 登记注册、移出和通知
* Observe: 接收输入
* 观察者模式: 对象之间是 **多对一依赖** 的一种设计方案, 被依赖的对象为 Subject , 依赖的对象为 Observe , Subject 通知 Observe 变化, 比如这里的奶站是 Subject , 是 1 的一方, 用户是 Observe, 是多的一方.



```
/**
 * 观察者模式的好处
 * 1. 观察者模式设计后, 会议集合的方式来管理用户, 包括注册, 移出, 以及通知
 * 2. 这样当我们增加观察者, 就不需要去修改核心类 WeatherData 的代码, 遵守了 OCP原则
 */
```



### JDK 中的观察者模式

* jdk 中Observable 类就使用到了观察者模式



